<!DOCTYPE html><html lang="zh-CN"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="一个包含有学习日记的博客">
    <meta name="author" content="uwupu">
    
    <title>
        
            Redis 3 Hash SortedSet |
        
        uwupu 学习日志
    </title>
    


    
        <link rel="shortcut icon" href="https://img2.uwupu.win/icon/tx3_round.png">
    
    
    
    
    
    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"zswh33.github.io","root":"/","language":"zh-CN","path":"search.json"}
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true,"layout":"right"},"style":{"primary_color":"#F099BC","logo":"https://img2.uwupu.win/icon/tx3_round.png","favicon":"https://img2.uwupu.win/icon/tx3_round.png","avatar":"https://img2.uwupu.win/icon/tx3_round.png","first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"哇！嗯嗯.","hitokoto":true},"scroll":{"progress_bar":true,"percent":true}},"local_search":{"enable":true,"preload":true},"code_block":{"tools":{"enable":true,"style":"mac"},"highlight_theme":"obsidian"},"pjax":{"enable":true},"lazyload":{"enable":true},"comment":{"enable":false,"use":"valine","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.21"},"waline":{"server_url":null,"reaction":false,"version":2},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false}},"post":{"author_label":{"enable":true,"auto":false,"custom_label_list":["啦啦啦啦啦"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm","copyright_info":true,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"version":"3.8.6"}
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"}
    KEEP.language_code_block = {"copy":"复制代码","copied":"已复制","fold":"折叠代码块","folded":"已折叠"}
    KEEP.language_copy_copyright = {"copy":"复制版权信息","copied":"已复制","title":"原文标题","author":"原文作者","link":"原文链接"}
  </script>
<meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="uwupu Blog" type="application/atom+xml">
<script>function loadCss(l){var d=document,h=d.head,s=d.createElement('link');s.rel='stylesheet';s.href=l;!function e(f){if (d.body)return f();setTimeout(function(){e(f)})}(function(){h.appendChild(s);});}loadCss('/style.css');loadCss('//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/font/css/fontawesome.min.css');loadCss('//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/font/css/regular.min.css');loadCss('//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/font/css/solid.min.css');loadCss('//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/font/css/brands.min.css');</script><noscript><link rel="stylesheet" href="/style.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/font/css/fontawesome.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/font/css/regular.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/font/css/solid.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/font/css/brands.min.css"></noscript></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
        <i class="pjax-progress-icon fas fa-circle-notch fa-spin"></i>
    
</div>


<main class="page-container border-box">

    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="https://img2.uwupu.win/icon/tx3_round.png">
                </a>
            
            <a class="site-name border-box" href="/">
               uwupu 学习日志
            </a>
        </div>

        <div class="right border-box">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class="" href="/">
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class="" href="/archives">
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class="" href="/tags">
                                标签
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class="" href="/categories">
                                分类
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class="" href="/links">
                                友链
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class="" href="/about">
                                关于
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class="" href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class="" href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class="" href="/tags">标签</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class="" href="/categories">分类</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class="" href="/links">友链</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class="" href="/about">关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">

                

                    <div class="fade-in-down-animation">
    <div class="post-page-container border-box">

        <div class="article-content-container border-box">

            

            <div class="article-content-bottom border-box">
                
                    <div class="article-title">
                        Redis 3 Hash SortedSet
                    </div>
                

                
                    <div class="article-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="https://img2.uwupu.win/icon/tx3_round.png">
                            </div>
                        
                        <div class="info-box">
                            <div class="author">
                                <span class="name">uwupu</span>
                                
                                    <span class="author-label">啦啦啦啦啦</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="article-meta-info-container border-box post">
    <div class="article-meta-info border-box">
        


        
            <span class="meta-info-item article-create-date">
                <i class="icon fa-solid fa-calendar-check"></i>&nbsp;
                <span class="pc">2022-09-21 09:23</span>
                <span class="mobile">2022-09-21 09:23</span>
            </span>

            <span class="meta-info-item article-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="pc" data-updated="Fri Nov 10 2023 23:15:27 GMT+0800">2023-11-10 23:15</span>
            </span>
        

        
            <span class="meta-info-item article-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul class="article-category-ul">
                    
                            <li class="category-item"><a href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></li>
                        
                    
                </ul>
            </span>
        

        
            <span class="article-tag meta-info-item border-box">
                <i class="icon fas fa-tags"></i>&nbsp;
                <ul class="article-tag-ul">
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/Redis/">Redis</a></li>
                        
                    
                </ul>
            </span>
        

        
        
            <span class="meta-info-item article-wordcount">
                <i class="icon fas fa-file-word"></i>&nbsp;<span>5.8k 字</span>
            </span>
        
        
            <span class="meta-info-item article-min2read">
                <i class="icon fas fa-clock"></i>&nbsp;<span>27 分钟</span>
            </span>
        
        
            <span class="meta-info-item article-pv">
                <i class="icon fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
            </span>
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="article-content keep-markdown-body">
                    

                    <h1 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h1><p>Hash用于存储field和value的映射表，适用于存储对象。</p>
<p>每个hash中可以存储2^32-1个field-value pair；</p>
<h2 id="使用-x2F-场景"><a href="#使用-x2F-场景" class="headerlink" title="使用/场景"></a>使用/场景</h2><h3 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h3><p><strong>缓存</strong>：更直观地维护缓存信息，如用户信息、饰品信息；</p>
<h3 id="例子：存储用户的属性"><a href="#例子：存储用户的属性" class="headerlink" title="例子：存储用户的属性"></a>例子：存储用户的属性</h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hset user:001 username ZhangSan firstName San lastName zhang age 21  # 在user:001中存储键值对 </span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">其中分别为 username:ZhangSan  firstName:San lastName:zhang age:21</span></span><br><span class="line">(integer) 4  # 返回field value对的数量</span><br><span class="line">127.0.0.1:6379&gt; hget user:001 username  # 查询user:001的username</span><br><span class="line">"ZhangSan"</span><br><span class="line">127.0.0.1:6379&gt; hgetall user:001  # 获取user:001的所有 field-value pair</span><br><span class="line">1) "username"</span><br><span class="line">2) "ZhangSan"</span><br><span class="line">3) "firstName"</span><br><span class="line">4) "San"</span><br><span class="line">5) "lastName"</span><br><span class="line">6) "zhang"</span><br><span class="line">7) "age"</span><br><span class="line">8) "21"</span><br></pre></td></tr></tbody></table></figure>

<h3 id="例子：存储设备的访问状态"><a href="#例子：存储设备的访问状态" class="headerlink" title="例子：存储设备的访问状态"></a>例子：存储设备的访问状态</h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hincrby device:2:stats pings 1  # device:2:stats的pings加一</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hincrby device:2:stats pings 1</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; hincrby device:2:stats pings 1</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; hincrby device:2:stats requests 1  # device:2:stats的requests加一</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hincrby device:2:stats errors 1  # device:2:stats的errors加一</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hget device:2:stats pings # 获取device:2:stats的pings</span><br><span class="line">"3"</span><br><span class="line">127.0.0.1:6379&gt; hmget device:2:stats requests errors  # 获取device:2:stats的requests和errors</span><br><span class="line">1) "1"</span><br><span class="line">2) "1"</span><br></pre></td></tr></tbody></table></figure>

<h2 id="基础命令"><a href="#基础命令" class="headerlink" title="基础命令"></a>基础命令</h2><p><strong>hset</strong>：hash设置值；</p>
<p><strong>hget</strong>：hash获取值；</p>
<p><strong>hmget</strong>：hash获取多个值；</p>
<p><strong>hincrby</strong>：若value可以为整数，则增加value的值。</p>
<h2 id="其他命令"><a href="#其他命令" class="headerlink" title="其他命令"></a>其他命令</h2><table>
<thead>
<tr>
<th>增</th>
<th>删</th>
<th>查</th>
</tr>
</thead>
<tbody><tr>
<td>HSET</td>
<td>HDEL</td>
<td>HGET</td>
</tr>
<tr>
<td>HSETNX</td>
<td></td>
<td>HMGET</td>
</tr>
<tr>
<td>HINCRBY</td>
<td></td>
<td>HEXISTS</td>
</tr>
<tr>
<td>HINCRBYFLOAT</td>
<td></td>
<td>HLEN</td>
</tr>
<tr>
<td></td>
<td></td>
<td>HSTRLEN</td>
</tr>
<tr>
<td></td>
<td></td>
<td>HRANDFIELD</td>
</tr>
</tbody></table>
<h3 id="HSET-设置值-可以多个"><a href="#HSET-设置值-可以多个" class="headerlink" title="HSET 设置值 可以多个"></a>HSET 设置值 可以多个</h3><p><code>hset key field value [field value ...]</code></p>
<p>设置hash的多个field-value对；</p>
<p>返回添加的field-value对数量。</p>
<h3 id="HSETNX-当field不存在则设置值"><a href="#HSETNX-当field不存在则设置值" class="headerlink" title="HSETNX 当field不存在则设置值"></a>HSETNX 当field不存在则设置值</h3><p><code>hsetnx key field value</code></p>
<p>当集合中没有指定field时，为集合添加field-value对；若集合中存在指定field，则不进行操作；</p>
<p>若key对应的set不存在，则创建一个集合；</p>
<p>返回值：</p>
<ul>
<li>若成功添加返回1；</li>
<li>若field已存在，操作没有执行，返回0。</li>
</ul>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hsetnx user:1 age 3</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hsetnx user:1 age 5</span><br><span class="line">(integer) 0</span><br></pre></td></tr></tbody></table></figure>

<h3 id="HGET-获得field的value"><a href="#HGET-获得field的value" class="headerlink" title="HGET 获得field的value"></a>HGET 获得field的value</h3><p><code>hget key field</code></p>
<p>获取集合中field对应的值；</p>
<p>若集合中没有field或集合不存在则返回nil；</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hsetnx user:1 age 3  # 设置user:1的age的值为3</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hget user:1 age  # 获取user:1的age值</span><br><span class="line">"3"</span><br></pre></td></tr></tbody></table></figure>

<h3 id="HMGET-获取field的value-可以多个"><a href="#HMGET-获取field的value-可以多个" class="headerlink" title="HMGET 获取field的value 可以多个"></a>HMGET 获取field的value 可以多个</h3><p><code>hmget key field [field ...]</code></p>
<p>获取集合中field对应的value。</p>
<p>返回一个数组，包含每个field对应的value；</p>
<p>若field不存在，则为nil；</p>
<p>若key不存在，视作空hash，将返回一个值为nil的数组；</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hset user:3 name zhangsan age 12 psw 1234565</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; hmget user:3 name age pass</span><br><span class="line">1) "zhangsan"</span><br><span class="line">2) "12"</span><br><span class="line">3) (nil)</span><br><span class="line">127.0.0.1:6379&gt; hmget user:4 name age</span><br><span class="line">1) (nil)</span><br><span class="line">2) (nil)</span><br></pre></td></tr></tbody></table></figure>

<h3 id="HGETALL-获得所有field-value"><a href="#HGETALL-获得所有field-value" class="headerlink" title="HGETALL 获得所有field-value"></a>HGETALL 获得所有field-value</h3><p><code>hgetall key</code></p>
<p>获取集合中所有的field-value对；</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hset user:2 name ZhangSan age 12 psw 123456</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; hgetall user:2</span><br><span class="line">1) "name"</span><br><span class="line">2) "ZhangSan"</span><br><span class="line">3) "age"</span><br><span class="line">4) "12"</span><br><span class="line">5) "psw"</span><br><span class="line">6) "123456"</span><br></pre></td></tr></tbody></table></figure>



<h3 id="HDEL-删除field-可以多个"><a href="#HDEL-删除field-可以多个" class="headerlink" title="HDEL 删除field 可以多个"></a>HDEL 删除field 可以多个</h3><p><code>hdel key field [field ...]</code></p>
<p>删除集合中的field-value 对；</p>
<p>返回成功删除的field的数量；</p>
<p>若key不存在，则返回0；</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hgetall user:2</span><br><span class="line">1) "name"</span><br><span class="line">2) "ZhangSan"</span><br><span class="line">3) "age"</span><br><span class="line">4) "12"</span><br><span class="line">5) "psw"</span><br><span class="line">6) "123456"</span><br><span class="line">127.0.0.1:6379&gt; hdel user:2 name age</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; hgetall user:2</span><br><span class="line">1) "psw"</span><br><span class="line">2) "123456"</span><br></pre></td></tr></tbody></table></figure>



<h3 id="HEXISTS-查询field存在"><a href="#HEXISTS-查询field存在" class="headerlink" title="HEXISTS 查询field存在"></a>HEXISTS 查询field存在</h3><p><code>hexists key field</code></p>
<p>若集合中存在field返回1，否则返回0；</p>
<h3 id="HLEN-获得field数量"><a href="#HLEN-获得field数量" class="headerlink" title="HLEN 获得field数量"></a>HLEN 获得field数量</h3><p><code>hlen key</code></p>
<p>返回集合field的数量。</p>
<h3 id="HSTRLEN-获得value的长度"><a href="#HSTRLEN-获得value的长度" class="headerlink" title="HSTRLEN 获得value的长度"></a>HSTRLEN 获得value的长度</h3><p><code>hstrlen key field</code></p>
<p>返回集合中field对应的value的长度，若key或field不存在返回0；</p>
<h3 id="HINCRBY-增加整型的值"><a href="#HINCRBY-增加整型的值" class="headerlink" title="HINCRBY  增加整型的值"></a>HINCRBY  增加整型的值</h3><p><code>hincrby key field increment</code></p>
<p>增加集合中field整型变量的值；</p>
<p>若key不存在，则自动创建一个集合，若field不存在，则在操作执行前将field的值设为0；</p>
<p>（即若key或field不存在，设集合key的field值为1）</p>
<p>（increment非可选变量，是必选变量）</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hincrby user:5 age 1</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hget user:5 age</span><br><span class="line">"1"</span><br></pre></td></tr></tbody></table></figure>

<h3 id="HINCRBYFLOAT-增加浮点数的值"><a href="#HINCRBYFLOAT-增加浮点数的值" class="headerlink" title="HINCRBYFLOAT  增加浮点数的值"></a>HINCRBYFLOAT  增加浮点数的值</h3><p><code>hincrbyfloat key field increment</code></p>
<p><em>Hash INCREment FLOAT</em></p>
<p>功能与hincrby类似，不同的是hincrbyfloat可以增加浮点数。</p>
<p>若increment为负，则为减少指定的值；</p>
<p>若key或field不存在，则在操作执行前，将key集合的field设为0（即操作执行后，值为1）</p>
<p>若<strong>field的value的类型不是数字</strong>或<strong>value的值不可被解析为一个浮点数</strong>，将返回错误信息；</p>
<p>若执行成功，返回增加后的值。</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hset user:6 age 3</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hincrbyfloat user:6 age 1.23</span><br><span class="line">"4.23"</span><br><span class="line">127.0.0.1:6379&gt; hset user:6 name ZhangSan</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hincrbyfloat user:6 name 1.23</span><br><span class="line">(error) ERR hash value is not a float</span><br></pre></td></tr></tbody></table></figure>

<h3 id="HRANDFIELD-随机获取field"><a href="#HRANDFIELD-随机获取field" class="headerlink" title="HRANDFIELD 随机获取field"></a>HRANDFIELD 随机获取field</h3><p>hrandfield key [count [WITHVALUES]]</p>
<p>获取集合中随机的field值；</p>
<p>若包含WITHVALUES参数，则返回field-value对；</p>
<p>关于count的使用：</p>
<ul>
<li>若count为正，返回指定数量的field，若count大于集合的基数，则返回集合的基数数量的field；</li>
<li>若count为负，返回|count|数量的field，且<strong>返回值可能存在重复</strong>；不论count与集合的基数大小关系，返回的结果的数量绝对是|count|；</li>
</ul>
<p>返回值：</p>
<ul>
<li>若没有count参数，则返回一个value；若key不存在返回nil；</li>
<li>若有count参数，则返回一个数组，若key不存在返回空数组；若包含WITHVALUES参数，则返回field和它对应的value。</li>
</ul>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hrandfield user:7 2</span><br><span class="line">1) "name"</span><br><span class="line">2) "psw"</span><br><span class="line">127.0.0.1:6379&gt; hrandfield user:7 10</span><br><span class="line">1) "name"</span><br><span class="line">2) "age"</span><br><span class="line">3) "psw"</span><br><span class="line">127.0.0.1:6379&gt; hrandfield user:7 2 WITHVALUES</span><br><span class="line">1) "name"</span><br><span class="line">2) "XiaoMing"</span><br><span class="line">3) "psw"</span><br><span class="line">4) "xm123"</span><br></pre></td></tr></tbody></table></figure>

<h3 id="HVALS-获取所有的values"><a href="#HVALS-获取所有的values" class="headerlink" title="HVALS 获取所有的values"></a>HVALS 获取所有的values</h3><p><code>HVALS key</code></p>
<p><em>Hash VALueS</em></p>
<p>返回所有的values；</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hgetall user:7</span><br><span class="line">1) "name"</span><br><span class="line">2) "XiaoMing"</span><br><span class="line">3) "age"</span><br><span class="line">4) "15"</span><br><span class="line">5) "psw"</span><br><span class="line">6) "xm123"</span><br><span class="line">127.0.0.1:6379&gt; hvals user:7</span><br><span class="line">1) "XiaoMing"</span><br><span class="line">2) "15"</span><br><span class="line">3) "xm123"</span><br></pre></td></tr></tbody></table></figure>

<h3 id="HMSET（弃用）-与hset一致"><a href="#HMSET（弃用）-与hset一致" class="headerlink" title="HMSET（弃用） 与hset一致"></a>HMSET（弃用） 与hset一致</h3><p>与hset功能相同，即将被弃用</p>
<h1 id="Sorted-Set"><a href="#Sorted-Set" class="headerlink" title="Sorted Set"></a>Sorted Set</h1><p>带有排序功能的set；</p>
<p><strong>排序方式：</strong>按照scores顺序存储字符串，若字符串有相同scores，则按照字典序存储字符串；</p>
<p>应用举例：</p>
<ul>
<li>游戏排名最高分；</li>
<li>通过滑动窗口限制同一时间内的API请求数量。</li>
</ul>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>Redis Sorted Set实现原理</p>
<ol>
<li><strong>压缩列表（ziplist）</strong>：ziplist是为了<strong>提高存储效率</strong>而设计的一种特殊编码的<strong>双向链表</strong>，可以存储<strong>字符串</strong>或<strong>整数</strong>；存储整数采用<strong>二进制而不是字符串</strong>；Ziplist能在O(1)的复杂度下完成list两端的push和pop操作；每次操作都需要重新分配ziplist的内存，实际复杂度与ziplist的内存使用量有关；</li>
<li><strong>跳跃表(zSkiplist)：</strong>跳跃表的性能可以保障查找、删除和添加等操作在对数期望时间内完成，跳跃表的复杂度是O(log(n))；</li>
</ol>
<h2 id="例子：游戏排名最高分"><a href="#例子：游戏排名最高分" class="headerlink" title="例子：游戏排名最高分"></a>例子：游戏排名最高分</h2><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd leaderboard 100 user:1 # 设置user:1的得分是100</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd leaderboard 89 user:2 # 设置user:2的得分是89</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd leaderboard 201 user:3 # 设置user:3的得分是201</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd leaderboard 23 user:4</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd leaderboard 111 user:5</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zrange leaderboard 0 2 REV WITHSCORES # 获取范围 0 2，REV逆序，WITHSCORES包含分数</span><br><span class="line">1) "user:3"</span><br><span class="line">2) "201"</span><br><span class="line">3) "user:5"</span><br><span class="line">4) "111"</span><br><span class="line">5) "user:1"</span><br><span class="line">6) "100"</span><br></pre></td></tr></tbody></table></figure>

<h2 id="基础命令-1"><a href="#基础命令-1" class="headerlink" title="基础命令"></a>基础命令</h2><p>ZADD：添加新的对象和分数到有序集合中，若对象存在，则更新分数；</p>
<p>ZRANGE：返回排序后的对象列表，可以选择排行榜的范围；</p>
<p>ZRANK：返回对象所在的排名；</p>
<p>ZREVRANK：返回集合在逆序下，对象所在的排名。</p>
<h2 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h2><p>zrange：O(log(n))</p>
<p>其他：O(log(n)+m)</p>
<h2 id="其他命令-1"><a href="#其他命令-1" class="headerlink" title="其他命令"></a>其他命令</h2><table>
<thead>
<tr>
<th>增</th>
<th>删</th>
<th>查</th>
<th>自增</th>
<th>并</th>
<th>交</th>
<th>差</th>
</tr>
</thead>
<tbody><tr>
<td>ZADD</td>
<td>ZREM</td>
<td>ZCARD</td>
<td>ZINCRBY</td>
<td>ZUNION</td>
<td>ZINTER</td>
<td>ZDIFF</td>
</tr>
<tr>
<td></td>
<td>ZREMRANGEBYLEX</td>
<td>ZCOUNT</td>
<td></td>
<td>ZUNIONSTORE</td>
<td>ZINTERCARD</td>
<td>ZDIFFSTORE</td>
</tr>
<tr>
<td></td>
<td>ZREMRANGEBYRANK</td>
<td>ZLEXCOUNT</td>
<td></td>
<td></td>
<td>ZINTERSTORE</td>
<td></td>
</tr>
<tr>
<td></td>
<td>ZREMRANGEBYSCORE</td>
<td>ZSCORE</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>ZPOPMAX</td>
<td>ZMSCORE</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>ZPOPMIN</td>
<td>ZRANDMEMBER</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>ZMPOP</td>
<td>ZRANGE</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>ZRANGEBYLEX</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>ZRANGEBYSCORE</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>ZRANGESTORE</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>ZREVRANGE</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>ZREVRANGEBYLEX</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>ZREVRANGEBYSCORE</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>ZRANK</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td>ZREVRANK</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="增"><a href="#增" class="headerlink" title="增"></a>增</h3><h4 id="ZADD"><a href="#ZADD" class="headerlink" title="ZADD"></a>ZADD</h4><h5 id="介绍-x2F-使用"><a href="#介绍-x2F-使用" class="headerlink" title="介绍/使用"></a>介绍/使用</h5><p><code>ZADD key [MX | XX] [GT | LT] [CH] [INCR] score member [score member ...]</code></p>
<ul>
<li><p>向有序集合中添加指定的对象和scores，可以指定多个member-score对；</p>
</li>
<li><p>如果集合中已存在要添加的member，则更新member的score为新输入的score；</p>
</li>
<li><p>如果key不存在，则创建相应的有序集合并将对象和score放进集合中；若key存在且类型不为有序集合，则返回错误；</p>
</li>
<li><p>score的值应为双精度浮点数的string格式；</p>
</li>
</ul>
<h5 id="可以用的参数"><a href="#可以用的参数" class="headerlink" title="可以用的参数"></a>可以用的参数</h5><ul>
<li>XX：仅更新已存在的元素，不添加新的元素；</li>
<li>NX：仅添加新的元素，不更新已存在的元素；</li>
<li>LT：若输入的score值小于原本的score值，则更新存在的值；</li>
<li>GT：若输入的score值大于原本的score值，则更新存在的值；</li>
<li>CH：返回值改为更新的元素数量；</li>
<li>INCR：将ZADD的作用变为ZINCRBY，此时只能指定一个score-element对；</li>
</ul>
<p>注意：GT、LT和NX三者是互斥的。</p>
<h5 id="实现-1"><a href="#实现-1" class="headerlink" title="实现"></a>实现</h5><p>Redis采用64位双精度浮点数来表示score，依据IEEE 754实现，能够精确的表示-(2^53 )到+(2^53)之间的数字。</p>
<h5 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h5><p>默认返回添加到有序集合的元素数量；</p>
<p>如果指定CH选项，则返回改变的元素的数量；</p>
<p>如果指定incr选项，若执行成功返回对象的score，操作取消则返回nil（被XX或NX选项阻止）。</p>
<h5 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h5><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd ss 10 a 20 b  # 设置 a=10 b=20</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; zadd ss XX CH 20 a 30 b  # 仅更新值，不添加新的元素</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zrange ss 0 -1 WITHSCORES</span><br><span class="line">1) "a"</span><br><span class="line">2) "20"</span><br><span class="line">3) "b"</span><br><span class="line">4) "30"</span><br><span class="line">127.0.0.1:6379&gt; zadd ss NX 5 c 69 b  # 仅添加新的元素，不更新值</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zrange ss 0 -1 WITHSCORES</span><br><span class="line">1) "c"  # c被添加</span><br><span class="line">2) "5"</span><br><span class="line">3) "a"</span><br><span class="line">4) "20"</span><br><span class="line">5) "b"</span><br><span class="line">6) "30"  # b没有被更新</span><br><span class="line">127.0.0.1:6379&gt; zadd ss LT 19 a 31 b # 仅当输入值小于原来的值时更新 </span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; zrange ss 0 -1 WITHSCORES</span><br><span class="line">1) "c"</span><br><span class="line">2) "5"</span><br><span class="line">3) "a"</span><br><span class="line">4) "19"   # a被更新</span><br><span class="line">5) "b"</span><br><span class="line">6) "30"  # b没有被更新</span><br><span class="line">127.0.0.1:6379&gt; zadd ss INCR 1 a   # 自增</span><br><span class="line">"20"</span><br></pre></td></tr></tbody></table></figure>

<p>LT : less than    &lt;</p>
<p>GT : great than  &gt;</p>
<p>LE : less equal  &lt;=</p>
<p>GE : great equal  &gt;=</p>
<h3 id="删"><a href="#删" class="headerlink" title="删"></a>删</h3><h4 id="ZREM"><a href="#ZREM" class="headerlink" title="ZREM"></a>ZREM</h4><p>ZREM key member [member …]</p>
<p>删除指定的对象；</p>
<p>成功返回移除的对象数量，不包含不存在的对象；若key不存在返回错误。</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd ss 1 a 2 b 3 c</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; zrem ss a d # 删除a成功， d不存在被忽略</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zrange ss 0 -1</span><br><span class="line">1) "b"</span><br><span class="line">2) "c"</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ZREMRANGEBYLEX"><a href="#ZREMRANGEBYLEX" class="headerlink" title="ZREMRANGEBYLEX"></a>ZREMRANGEBYLEX</h4><p><code>ZREMRANGEBYLEX key min max</code></p>
<p>删除<strong>字典序</strong>排序从min到max的元素；</p>
<p>返回被移除的元素数量。</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd ss 1 a 2 d 3 e 4 g 5 i 6 w 7 y 8 z</span><br><span class="line">(integer) 8</span><br><span class="line">127.0.0.1:6379&gt; zremrangebylex ss [e [w</span><br><span class="line">(integer) 4</span><br><span class="line">127.0.0.1:6379&gt; zrange ss 0 -1</span><br><span class="line">1) "a"</span><br><span class="line">2) "d"</span><br><span class="line">3) "y"</span><br><span class="line">4) "z"</span><br></pre></td></tr></tbody></table></figure>

<p>在命令内部使用 “[字符串”表示范围，如：[assd</p>
<h4 id="ZREMRANGEBYSCORE"><a href="#ZREMRANGEBYSCORE" class="headerlink" title="ZREMRANGEBYSCORE"></a>ZREMRANGEBYSCORE</h4><p><code>ZREMRANGEBYSCORE key min max</code></p>
<p>删除<strong>score值</strong>是从min到max的元素。</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrange ss2 0 -1 WITHSCORES</span><br><span class="line"> 1) "w"</span><br><span class="line"> 2) "7"</span><br><span class="line"> 3) "s"</span><br><span class="line"> 4) "8"</span><br><span class="line"> 5) "c"</span><br><span class="line"> 6) "9"</span><br><span class="line"> 7) "x"</span><br><span class="line"> 8) "10"</span><br><span class="line"> 9) "l"</span><br><span class="line">10) "11"</span><br><span class="line">127.0.0.1:6379&gt; ZREMRANGEBYSCORE ss2 8 9  # 删除scores范围为 8 ~ 9 的值。</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; zrange ss2 0 -1 WITHSCORES</span><br><span class="line">1) "w"</span><br><span class="line">2) "7"</span><br><span class="line">3) "x"</span><br><span class="line">4) "10"</span><br><span class="line">5) "l"</span><br><span class="line">6) "11"</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ZREMRANGEBYRANK"><a href="#ZREMRANGEBYRANK" class="headerlink" title="ZREMRANGEBYRANK"></a>ZREMRANGEBYRANK</h4><p><code>ZREMRANGEBYRANK key start stop</code></p>
<p>删除<strong>排名</strong>从start到stop的元素；</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrange ss 0 -1</span><br><span class="line">1) "a"</span><br><span class="line">2) "c"</span><br><span class="line">3) "d"</span><br><span class="line">4) "w"</span><br><span class="line">5) "f"</span><br><span class="line">127.0.0.1:6379&gt; zremrangebyrank ss 1 3  # 删除排名位于 1 ~ 3 的元素</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; zrange ss 0 -1</span><br><span class="line">1) "a"</span><br><span class="line">2) "f"</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ZPOPMAX、ZPOPMIN"><a href="#ZPOPMAX、ZPOPMIN" class="headerlink" title="ZPOPMAX、ZPOPMIN"></a>ZPOPMAX、ZPOPMIN</h4><p><code>ZPOPMAX key [count]</code></p>
<p><code>ZPOPMIN key [count]</code></p>
<p>移除scores值 MAX最高（MIN最低）的count个元素；</p>
<p>若没有count属性，默认count为1；</p>
<p>返回多个元素，score最大（MAX为最大的，MIN为最小的）的元素在首位，其他依次向下排列；</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrange ss2 0 -1 WITHSCORES</span><br><span class="line">1) "w"</span><br><span class="line">2) "7"</span><br><span class="line">3) "x"</span><br><span class="line">4) "10"</span><br><span class="line">5) "l"</span><br><span class="line">6) "11"</span><br><span class="line">127.0.0.1:6379&gt; zpopmax ss2 2</span><br><span class="line">1) "l"</span><br><span class="line">2) "11"</span><br><span class="line">3) "x"</span><br><span class="line">4) "10"</span><br><span class="line">127.0.0.1:6379&gt; zrange ss2 0 -1 WITHSCORES</span><br><span class="line">1) "w"</span><br><span class="line">2) "7"</span><br></pre></td></tr></tbody></table></figure>



<h4 id="ZMPOP-依据提供的方向删除指定集合指定数量的元素"><a href="#ZMPOP-依据提供的方向删除指定集合指定数量的元素" class="headerlink" title="ZMPOP 依据提供的方向删除指定集合指定数量的元素"></a>ZMPOP 依据提供的方向删除指定集合指定数量的元素</h4><p>ZMPOP numkeys key [key …] &lt;MIN | MAX&gt; [COUNT count]</p>
<p>从给定的集合中从前往后寻找非空集合，删除并返回多个元素。</p>
<p>可以指定多个集合；</p>
<p>在MIN下，将对在非空集合中score最低的元素进行pop；MAX反之；</p>
<p>COUNT指定要pop的数量；</p>
<p>返回值：</p>
<ul>
<li>返回一个二维数组（<code>[n][2]</code>），子数组包含删除元素的对象和score；</li>
<li>若没有元素被pop则返回nil</li>
</ul>
<h3 id="查"><a href="#查" class="headerlink" title="查"></a>查</h3><h4 id="ZCARD"><a href="#ZCARD" class="headerlink" title="ZCARD"></a>ZCARD</h4><p><code>ZCARD key</code></p>
<p>查询集合的基数。</p>
<h4 id="ZCOUNT、ZLEXCOUNT"><a href="#ZCOUNT、ZLEXCOUNT" class="headerlink" title="ZCOUNT、ZLEXCOUNT"></a>ZCOUNT、ZLEXCOUNT</h4><p><code>ZCOUNT key min max</code>  获取score在min到max之间的元素。O(log(N))。</p>
<p><code>ZLEXCOUNT key min max</code> 依据字典序获得min到max之间的元素。O(log(N))。</p>
<p>返回指定结果数量；</p>
<h4 id="ZSCORE"><a href="#ZSCORE" class="headerlink" title="ZSCORE"></a>ZSCORE</h4><p><code>ZSCORE key member</code></p>
<p>返回成员的score；</p>
<p>若成员或key不存在，返回nil；</p>
<h4 id="ZMSCORE"><a href="#ZMSCORE" class="headerlink" title="ZMSCORE"></a>ZMSCORE</h4><p><code>ZMSCORE key member [member ...]</code></p>
<p>返回多个成员的score；</p>
<p>对于每个成员，若member不存在，则score以nil代替。</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd ss 1 a 2 b 3 c</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; zmscore ss a b</span><br><span class="line">1) "1"</span><br><span class="line">2) "2"</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ZRANDMEMBER"><a href="#ZRANDMEMBER" class="headerlink" title="ZRANDMEMBER"></a>ZRANDMEMBER</h4><p><code>ZRANDMEMBER key [count [WITHSCORES]]</code></p>
<p>若只有key参数，则在集合中随机获取一个元素并返回其成员名；</p>
<p>若有count参数，</p>
<ul>
<li>若count为正数，在集合中随机获取多个元素并返回其成员名，数量取count和基数的最小值；</li>
<li>若count为负数，获取的结果会有重复，返回的数量绝对为count，不受基数大小限制。</li>
</ul>
<p>若加上WITHSCORES，返回参数包含成员名及其scores。</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; ZRANDMEMBER ss 2</span><br><span class="line">1) "c"</span><br><span class="line">2) "a"</span><br><span class="line">127.0.0.1:6379&gt; ZRANDMEMBER ss 2 WITHSCORES</span><br><span class="line">1) "b"</span><br><span class="line">2) "2"</span><br><span class="line">3) "a"</span><br><span class="line">4) "1"</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ZRANGE"><a href="#ZRANGE" class="headerlink" title="ZRANGE"></a>ZRANGE</h4><h5 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h5><p><code>ZRANGE key start stop [BYSCORE | BYLEX] [REV] [LIMIT offset count] [WITHSCORES]</code></p>
<p>依据条件进行查询，返回结果顺序默认从低到高；若start大于基数或stop，则返回空集合；若stop大于基数，视为最后一个元素。</p>
<p>ZRANGE可以查询来自不同类型范围的元素；</p>
<h5 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h5><p>start，stop：值的起点和终点，即值的范围为 start ~ stop；</p>
<ul>
<li>第一个元素用0表示，第二个为1，其他依次类推；</li>
<li>start/stop值也可以为负，-1表示倒数第一个，-2表示倒数第二个；</li>
<li>对于不同的<strong>排序依据</strong>，可以使用的值不同；<ul>
<li>默认情况下<ul>
<li>start/stop表示查询地范围，结果包含start/stop索引所在位置的值；</li>
</ul>
</li>
<li>对于BYSCORE<ul>
<li>默认情况下，结果包含start/stop指定的索引位置，可以通过添加前缀”**(**“来表示不包含start/stop指定的索引位置的值；</li>
<li>默认情况下，start表示最小score，stop表示最大score；</li>
<li>也可以为 “+inf”或“-inf”，分别表示正无穷和负无穷。</li>
<li>若使用REV参数，就必须将start和stop的值反过来使用，也就是start &gt; stop，否则将获得一个空的结果；start表示最大score，stop表示最score。</li>
</ul>
</li>
<li>对于BYLEX<ul>
<li>start/stop值必须包含“(”或“[”表示不包含或包含start/stop指定的索引位置的值；</li>
<li>可以使用“+”或者“-”表示正无穷和负无穷；</li>
<li>若使用REV参数，就必须将start和stop的值反过来，也就是 start &gt; stop，否则将返回一个空的结果。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>BYSCORE：依据score；</p>
<p>BYLEX：依据字典序；在此模式下不支持REV参数，会返回错误；</p>
<p>REV：查询结果默认排序为从低到高，使用REV参数后排序改为从高到低；</p>
<p>LIMIT：在获得结果中取出指定范围的数据进行返回；offset为起点；count为取出的数量，若count为负则取出从offset到最后所有的元素；注意若offset很大，需要遍历从offset到最后一个元素之间的所有元素，时间复杂度为O(N)；</p>
<p>WITHSCORES：返回值包含score；</p>
<h5 id="返回值-1"><a href="#返回值-1" class="headerlink" title="返回值"></a>返回值</h5><p>返回数组，包含元素列表；若有WITHSCORES，则同时包含scores。</p>
<h5 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h5><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd ss 12 a 23 b 34 c 45 d 56 e 67 f</span><br><span class="line">(integer) 6</span><br><span class="line">127.0.0.1:6379&gt; zrange ss 0 -1 # 查询队列中所有的元素</span><br><span class="line">1) "a"</span><br><span class="line">2) "b"</span><br><span class="line">3) "c"</span><br><span class="line">4) "d"</span><br><span class="line">5) "e"</span><br><span class="line">6) "f"</span><br><span class="line">127.0.0.1:6379&gt; zrange ss 2 -1 WITHSCORES # 查询队列中从位置2到最后的元素，包含scores</span><br><span class="line">1) "c"</span><br><span class="line">2) "34"</span><br><span class="line">3) "d"</span><br><span class="line">4) "45"</span><br><span class="line">5) "e"</span><br><span class="line">6) "56"</span><br><span class="line">7) "f"</span><br><span class="line">8) "67"</span><br><span class="line">127.0.0.1:6379&gt; zrange ss 45 56 BYSCORE WITHSCORES # 查询score从45到56范围内的元素</span><br><span class="line">1) "d"</span><br><span class="line">2) "45"</span><br><span class="line">3) "e"</span><br><span class="line">4) "56"</span><br><span class="line">127.0.0.1:6379&gt; zrange ss 56 45 REV BYSCORE WITHSCORES # 逆序，start/stop需要倒过来</span><br><span class="line">1) "e"</span><br><span class="line">2) "56"</span><br><span class="line">3) "d"</span><br><span class="line">4) "45"</span><br><span class="line">127.0.0.1:6379&gt; zrange ss (c [e REV BYLEX WITHSCORES # 使用BYLEX不能使用WITHSCORES</span><br><span class="line">(error) ERR syntax error, WITHSCORES not supported in combination with BYLEX</span><br><span class="line">127.0.0.1:6379&gt; zrange ss (c [e REV BYLEX # 使用REV需要将start/stop的值倒过来，否则返回空数组</span><br><span class="line">(empty array)</span><br><span class="line">127.0.0.1:6379&gt; zrange ss (c [e BYLEX # 不包含c，包含e的结果。</span><br><span class="line">1) "d"</span><br><span class="line">2) "e"</span><br><span class="line">127.0.0.1:6379&gt; zrange ss (c [e BYLEX LIMIT 1 1 # 取出结果中从索引1开始，1个元素</span><br><span class="line">1) "e"</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ZRANGESTORE"><a href="#ZRANGESTORE" class="headerlink" title="ZRANGESTORE"></a>ZRANGESTORE</h4><p><code>ZRANGESTORE dst src min max [BYSCORE | BYLEX] [REV] [LIMIT offset count]</code></p>
<p>查询方式与ZRANGE一致；</p>
<p>不同的是，可以将返回结果存储到指定集合中；</p>
<p>返回值为结果集的元素数量；</p>
<p>注意：不能使用WITHSCORES。</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrange ss 45 56 BYSCORE WITHSCORES</span><br><span class="line">1) "d"</span><br><span class="line">2) "45"</span><br><span class="line">3) "e"</span><br><span class="line">4) "56"</span><br><span class="line">127.0.0.1:6379&gt; zrangestore ss2 ss 45 56 BYSCORE</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; zrange ss2 0 -1 WITHSCORES</span><br><span class="line">1) "d"</span><br><span class="line">2) "45"</span><br><span class="line">3) "e"</span><br><span class="line">4) "56"</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ZRANK"><a href="#ZRANK" class="headerlink" title="ZRANK"></a>ZRANK</h4><p><code>ZRANK key member</code></p>
<p>将集合按照score大小进行排序，返回排序结果中member的位置。</p>
<p>排序顺序<strong>从小到大</strong>；</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrange ss 0 -1</span><br><span class="line">1) "a" #  0 5</span><br><span class="line">2) "b" #  1 4</span><br><span class="line">3) "c" #  2 3  c的正序位置在2，逆序位置在3</span><br><span class="line">4) "d" #  3 2</span><br><span class="line">5) "e" #  4 1</span><br><span class="line">6) "f" #  5 0</span><br><span class="line">127.0.0.1:6379&gt; zrank ss c</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; zrevrank ss c</span><br><span class="line">(integer) 3</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ZREVRANK"><a href="#ZREVRANK" class="headerlink" title="ZREVRANK"></a>ZREVRANK</h4><p><code>ZREVRANK key member</code></p>
<p>返回集合按照score排行，反转后的member的位置；</p>
<p>排行按照从高到低；</p>
<p>返回值：若成员存在，返回成员的排行；若成员或key不存在，返回nil；</p>
<h4 id="ZRANGEBYLEX、ZRANGEBYSCORE-（弃用）"><a href="#ZRANGEBYLEX、ZRANGEBYSCORE-（弃用）" class="headerlink" title="ZRANGEBYLEX、ZRANGEBYSCORE （弃用）"></a>ZRANGEBYLEX、ZRANGEBYSCORE （弃用）</h4><p>将会被ZRANGE取代；</p>
<p><code>ZRANGEBYLEX key min max [LIMIT offset count]</code></p>
<p><code>ZRANGEBYSCORE key min max [LIMIT offset count] WITHSCORES</code></p>
<h4 id="ZREVRANGE（弃用）"><a href="#ZREVRANGE（弃用）" class="headerlink" title="ZREVRANGE（弃用）"></a>ZREVRANGE（弃用）</h4><p><code>ZREVRANGE key start stop [WITHSCORES]</code></p>
<h4 id="ZREVRANGEBYLEX（弃用）"><a href="#ZREVRANGEBYLEX（弃用）" class="headerlink" title="ZREVRANGEBYLEX（弃用）"></a>ZREVRANGEBYLEX（弃用）</h4><p><code>ZREVRANGEBYLEX key max min [LIMIT offset count]</code></p>
<h4 id="ZRANGEBYSCORE（弃用）"><a href="#ZRANGEBYSCORE（弃用）" class="headerlink" title="ZRANGEBYSCORE（弃用）"></a>ZRANGEBYSCORE（弃用）</h4><p><code>ZREVRANGEBYSCORE key max min [WITHSCORES] [LIMIT offset count]</code></p>
<h3 id="并集"><a href="#并集" class="headerlink" title="并集"></a>并集</h3><h4 id="ZUNIONSTORE"><a href="#ZUNIONSTORE" class="headerlink" title="ZUNIONSTORE"></a>ZUNIONSTORE</h4><p><code>ZUNIONSTORE destination numkeys key [key ...] [WEIGHTS weight [weight ...]] [AGGREAGTE &lt;SUM | MIN MAX&gt;]</code></p>
<p>计算numkeys个集合的并集结果，对于每个相同的member，将相应的score进行处理（相加，MAX，MIN），然后存储计算结果到destination中；</p>
<p>在提供key和其他参数之前，必须提供numkeys；</p>
<p>参数介绍：</p>
<ul>
<li><p>使用WEIGHTS参数，指定多个乘数，将为每个集合的score值在处理之前与指定的乘数相乘，乘法因子默认为1；</p>
<ul>
<li>如：</li>
<li>设 k1 = {a:1,b:2}  k2 = {b:3,c:4}</li>
<li>如：ZUNIONSTORE out 2 k1 k2 WEIGHTS 2 3 AGGREGATE SUM</li>
<li><ol>
<li>k1’ = {a:2,b:4}  k2’ = {b:9,c:12}</li>
<li>out = {a:2,b:13,c:12}</li>
</ol>
</li>
</ul>
</li>
<li><p>使用AGGREGATE选项，可以指定UNION过程score的处理方法，默认为SUM；</p>
<ul>
<li>SUM：将所有score相加；</li>
<li>MAX：取所有score最大值；</li>
<li>MIN：取所有score最小值。</li>
</ul>
</li>
</ul>
<p>若destination中有值，则进行覆盖。</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd s1 1 a 4 b  # s1 = {a:1, b:4}</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; zadd s2 4 a 5 c  # s2 = {a:4, c:5}</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; ZUNIONSTORE out1 2 s1 s2 WEIGHTS 2 3 # 将s1和s2进行UNION操作，AGGREGATE为SUM</span><br><span class="line">(integer) 3 # 结果集的值的数量</span><br><span class="line">127.0.0.1:6379&gt; ZRANGE out1 0 -1 WITHSCORES # 查询</span><br><span class="line">1) "b"</span><br><span class="line">2) "8"   # 4x2 = 8</span><br><span class="line">3) "a"</span><br><span class="line">4) "14"  # 1x2 + 4x3 = 14</span><br><span class="line">5) "c"</span><br><span class="line">6) "15"  # 5x3 = 15</span><br><span class="line">127.0.0.1:6379&gt; ZUNIONSTORE out2 2 s1 s2 WEIGHTS 2 3 AGGREGATE MAX # 将s1和s2进行UNION操作，AGGREGATE为MAX</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; ZRANGE out2 0 -1 WITHSCORES</span><br><span class="line">1) "b"</span><br><span class="line">2) "8"   # 4x2 = 8</span><br><span class="line">3) "a"</span><br><span class="line">4) "12"  # max(1x2, 4x3) = 12</span><br><span class="line">5) "c"</span><br><span class="line">6) "15"  # 5x3 = 15</span><br><span class="line">127.0.0.1:6379&gt; ZUNIONSTORE out3 2 s1 s2 WEIGHTS 2 3 AGGREGATE MIN # 将s1和s2进行UNION操作，AGGREGATE为MIN</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; ZRANGE out3 0 -1 WITHSCORES</span><br><span class="line">1) "a"</span><br><span class="line">2) "2"  # min(2x1, 3x4) = 2</span><br><span class="line">3) "b"</span><br><span class="line">4) "8"</span><br><span class="line">5) "c"</span><br><span class="line">6) "15"</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ZUNION"><a href="#ZUNION" class="headerlink" title="ZUNION"></a>ZUNION</h4><p><code>ZUNION numkeys key [key ...] [WEIGHTS weight [weight ...]] [AGGREGATE &lt;SUM | MIN | MAX&gt;] [WITHSCORES]</code></p>
<p>功能类似于ZUNIONSTORE，不同的是，ZUNION将计算结果返回到客户端；</p>
<h3 id="交集"><a href="#交集" class="headerlink" title="交集"></a>交集</h3><h4 id="ZINTER"><a href="#ZINTER" class="headerlink" title="ZINTER"></a>ZINTER</h4><p><code>ZINTER numkeys key [key ...] [WEIGHTS weight [weight ...]] [AGGREGATE &lt;SUM | MIN | MAX&gt;][WITHSCORES]</code></p>
<p>将交集结果返回到客户端；</p>
<p>时间复杂度：</p>
<p>O(NK)+O(Mlog(M))</p>
<p>N：最小有序集合</p>
<p>K：有序集合的数量</p>
<p>M：结果集元素数量</p>
<p>返回交集结果。</p>
<h4 id="ZINTERCARD"><a href="#ZINTERCARD" class="headerlink" title="ZINTERCARD"></a>ZINTERCARD</h4><p><code>ZINTERCARD numkeys key [key ...] [LIMIT limit]</code></p>
<p>返回结果集的基数；</p>
<p>若key为空，则被视为空集合，返回0；</p>
<p>默认情况下，ZINTERCARD计算集合中所有的数量，可以通过给出参数LIMIT（默认为0）来限制计算数量，这样可以减少计算加速运行；</p>
<h4 id="ZINTERSTORE"><a href="#ZINTERSTORE" class="headerlink" title="ZINTERSTORE"></a>ZINTERSTORE</h4><p><code>ZINTERSTORE destination numkeys key [key ...] [WEIGHTS weight [weight ...]] [AGGREGATE &lt;SUM | MIN |MAX&gt;]</code></p>
<p>计算交集结果并存放在destination中；</p>
<p>若destination原本存在，则进行覆盖。</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrange s1 0 -1 WITHSCORES # s1 = {a:1, b:4}</span><br><span class="line">1) "a"</span><br><span class="line">2) "1"</span><br><span class="line">3) "b"</span><br><span class="line">4) "4"</span><br><span class="line">127.0.0.1:6379&gt; zrange s2 0 -1 WITHSCORES # s2 = {a:4, c:5}</span><br><span class="line">1) "a"</span><br><span class="line">2) "4"</span><br><span class="line">3) "c"</span><br><span class="line">4) "5"</span><br><span class="line">127.0.0.1:6379&gt; ZINTERSTORE out4 2 s1 s2 WEIGHTS 2 3 # 将交集计算结果存放到out4中，</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zrange out4 0 -1 WITHSCORES</span><br><span class="line">1) "a"</span><br><span class="line">2) "14"  # 1x2 + 3x4 = 14</span><br></pre></td></tr></tbody></table></figure>

<h3 id="差集"><a href="#差集" class="headerlink" title="差集"></a>差集</h3><h4 id="ZDIFFSTORE"><a href="#ZDIFFSTORE" class="headerlink" title="ZDIFFSTORE"></a>ZDIFFSTORE</h4><p><code>ZDIFFSTORE destination numkeys key [key ...]</code></p>
<p>计算第一个集合与其他集合的差集，将结果存放到destination；</p>
<p>numkeys为指定key的数量；</p>
<p>若destination存在，则进行覆盖。</p>
<p>与INTER和UNION不同，DIFF不对SCORE进行运算，而是仅使用member作为依据对集合进行差集运算。</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zrange s1 0 -1 WITHSCORES</span><br><span class="line">1) "a"</span><br><span class="line">2) "1"</span><br><span class="line">3) "b"</span><br><span class="line">4) "4"</span><br><span class="line">127.0.0.1:6379&gt; zrange s2 0 -1 WITHSCORES</span><br><span class="line">1) "a"</span><br><span class="line">2) "4"</span><br><span class="line">3) "c"</span><br><span class="line">4) "5"</span><br><span class="line">127.0.0.1:6379&gt; ZDIFFSTORE out5 2 s1 s2</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; zrange out5 0 -1 WITHSCORES # s1与s2的差集为{b:4}</span><br><span class="line">1) "b" </span><br><span class="line">2) "4"</span><br></pre></td></tr></tbody></table></figure>

<h4 id="ZDIFF"><a href="#ZDIFF" class="headerlink" title="ZDIFF"></a>ZDIFF</h4><p><code>ZDIFF numkeys key [key ...] [WITHSCORES]</code></p>
<p>功能类似于ZDIFFSTORE，不同的是，ZDIFF将计算结果返回到客户端；</p>

                </div>

                
                        
<div class="article-copyright-info-container border-box">
    <div class="copyright-info-content border-box">
        <div class="copyright-info-top border-box">
            <div class="post-title border-box text-ellipsis">
                Redis 3 Hash SortedSet
            </div>

            <div class="post-link border-box text-ellipsis">
                2022/09/21/Redis/Redis-3/
            </div>
        </div>

        <div class="copyright-info-bottom border-box">
            <div class="post-author bottom-item">
                <div class="type">
                    作者
                </div>
                <div class="content">uwupu</div>
            </div>

            <div class="post-time bottom-item">
                <div class="type">
                    发布于
                </div>
                <div class="content">2022-09-21 09:23</div>
            </div>


            <div class="post-license bottom-item">
                <div class="type">
                    许可
                </div>
                <div class="content tooltip" data-tooltip-content="CC BY-NC-SA 4.0">
                    <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hans">
                        <i class="fa-brands fa-creative-commons"></i>
                        <i class="fa-brands fa-creative-commons-by"></i>
                        <i class="fa-brands fa-creative-commons-nc"></i>
                        <i class="fa-brands fa-creative-commons-sa"></i>
                    </a>
                </div>
            </div>
        </div>

        <i class="copyright-bg fa-solid fa-copyright"></i>
    </div>
    <div class="copy-copyright-info flex-center tooltip" data-tooltip-content="复制版权信息" data-tooltip-offset-y="-2px">
        <i class="fa-solid fa-copy"></i>
    </div>
</div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/Redis/">Redis</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                    </div>
                </div>

                

                
                    <div class="article-nav">
                        
                            <div class="article-prev">
                                <a class="prev" rel="prev" href="/2022/09/21/Redis/Redis-4/" title="Redis 4 Stream">
                                    <span class="left arrow-icon flex-center">
                                      <i class="fas fa-chevron-left"></i>
                                    </span>
                                            <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">Redis 4 Stream</span>
                                        <span class="post-nav-item">上一篇</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="article-next">
                                <a class="next" rel="next" href="/2022/09/20/Redis/Redis-2/" title="Redis 2 List Set">
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">Redis 2 List Set</span>
                                        <span class="post-nav-item">下一篇</span>
                                    </span>
                                            <span class="right arrow-icon flex-center">
                                      <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    






                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Hash"><span class="nav-number">1.</span> <span class="nav-text">Hash</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-x2F-%E5%9C%BA%E6%99%AF"><span class="nav-number">1.1.</span> <span class="nav-text">使用/场景</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF"><span class="nav-number">1.1.1.</span> <span class="nav-text">场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90%EF%BC%9A%E5%AD%98%E5%82%A8%E7%94%A8%E6%88%B7%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="nav-number">1.1.2.</span> <span class="nav-text">例子：存储用户的属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90%EF%BC%9A%E5%AD%98%E5%82%A8%E8%AE%BE%E5%A4%87%E7%9A%84%E8%AE%BF%E9%97%AE%E7%8A%B6%E6%80%81"><span class="nav-number">1.1.3.</span> <span class="nav-text">例子：存储设备的访问状态</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.</span> <span class="nav-text">基础命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%91%BD%E4%BB%A4"><span class="nav-number">1.3.</span> <span class="nav-text">其他命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HSET-%E8%AE%BE%E7%BD%AE%E5%80%BC-%E5%8F%AF%E4%BB%A5%E5%A4%9A%E4%B8%AA"><span class="nav-number">1.3.1.</span> <span class="nav-text">HSET 设置值 可以多个</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HSETNX-%E5%BD%93field%E4%B8%8D%E5%AD%98%E5%9C%A8%E5%88%99%E8%AE%BE%E7%BD%AE%E5%80%BC"><span class="nav-number">1.3.2.</span> <span class="nav-text">HSETNX 当field不存在则设置值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HGET-%E8%8E%B7%E5%BE%97field%E7%9A%84value"><span class="nav-number">1.3.3.</span> <span class="nav-text">HGET 获得field的value</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HMGET-%E8%8E%B7%E5%8F%96field%E7%9A%84value-%E5%8F%AF%E4%BB%A5%E5%A4%9A%E4%B8%AA"><span class="nav-number">1.3.4.</span> <span class="nav-text">HMGET 获取field的value 可以多个</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HGETALL-%E8%8E%B7%E5%BE%97%E6%89%80%E6%9C%89field-value"><span class="nav-number">1.3.5.</span> <span class="nav-text">HGETALL 获得所有field-value</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HDEL-%E5%88%A0%E9%99%A4field-%E5%8F%AF%E4%BB%A5%E5%A4%9A%E4%B8%AA"><span class="nav-number">1.3.6.</span> <span class="nav-text">HDEL 删除field 可以多个</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HEXISTS-%E6%9F%A5%E8%AF%A2field%E5%AD%98%E5%9C%A8"><span class="nav-number">1.3.7.</span> <span class="nav-text">HEXISTS 查询field存在</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HLEN-%E8%8E%B7%E5%BE%97field%E6%95%B0%E9%87%8F"><span class="nav-number">1.3.8.</span> <span class="nav-text">HLEN 获得field数量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HSTRLEN-%E8%8E%B7%E5%BE%97value%E7%9A%84%E9%95%BF%E5%BA%A6"><span class="nav-number">1.3.9.</span> <span class="nav-text">HSTRLEN 获得value的长度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HINCRBY-%E5%A2%9E%E5%8A%A0%E6%95%B4%E5%9E%8B%E7%9A%84%E5%80%BC"><span class="nav-number">1.3.10.</span> <span class="nav-text">HINCRBY  增加整型的值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HINCRBYFLOAT-%E5%A2%9E%E5%8A%A0%E6%B5%AE%E7%82%B9%E6%95%B0%E7%9A%84%E5%80%BC"><span class="nav-number">1.3.11.</span> <span class="nav-text">HINCRBYFLOAT  增加浮点数的值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HRANDFIELD-%E9%9A%8F%E6%9C%BA%E8%8E%B7%E5%8F%96field"><span class="nav-number">1.3.12.</span> <span class="nav-text">HRANDFIELD 随机获取field</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HVALS-%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E7%9A%84values"><span class="nav-number">1.3.13.</span> <span class="nav-text">HVALS 获取所有的values</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HMSET%EF%BC%88%E5%BC%83%E7%94%A8%EF%BC%89-%E4%B8%8Ehset%E4%B8%80%E8%87%B4"><span class="nav-number">1.3.14.</span> <span class="nav-text">HMSET（弃用） 与hset一致</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Sorted-Set"><span class="nav-number">2.</span> <span class="nav-text">Sorted Set</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0"><span class="nav-number">2.1.</span> <span class="nav-text">实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90%EF%BC%9A%E6%B8%B8%E6%88%8F%E6%8E%92%E5%90%8D%E6%9C%80%E9%AB%98%E5%88%86"><span class="nav-number">2.2.</span> <span class="nav-text">例子：游戏排名最高分</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4-1"><span class="nav-number">2.3.</span> <span class="nav-text">基础命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD"><span class="nav-number">2.4.</span> <span class="nav-text">性能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%91%BD%E4%BB%A4-1"><span class="nav-number">2.5.</span> <span class="nav-text">其他命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A2%9E"><span class="nav-number">2.5.1.</span> <span class="nav-text">增</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ZADD"><span class="nav-number">2.5.1.1.</span> <span class="nav-text">ZADD</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D-x2F-%E4%BD%BF%E7%94%A8"><span class="nav-number">2.5.1.1.1.</span> <span class="nav-text">介绍/使用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%AF%E4%BB%A5%E7%94%A8%E7%9A%84%E5%8F%82%E6%95%B0"><span class="nav-number">2.5.1.1.2.</span> <span class="nav-text">可以用的参数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0-1"><span class="nav-number">2.5.1.1.3.</span> <span class="nav-text">实现</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="nav-number">2.5.1.1.4.</span> <span class="nav-text">返回值</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81"><span class="nav-number">2.5.1.1.5.</span> <span class="nav-text">代码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0"><span class="nav-number">2.5.2.</span> <span class="nav-text">删</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ZREM"><span class="nav-number">2.5.2.1.</span> <span class="nav-text">ZREM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZREMRANGEBYLEX"><span class="nav-number">2.5.2.2.</span> <span class="nav-text">ZREMRANGEBYLEX</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZREMRANGEBYSCORE"><span class="nav-number">2.5.2.3.</span> <span class="nav-text">ZREMRANGEBYSCORE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZREMRANGEBYRANK"><span class="nav-number">2.5.2.4.</span> <span class="nav-text">ZREMRANGEBYRANK</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZPOPMAX%E3%80%81ZPOPMIN"><span class="nav-number">2.5.2.5.</span> <span class="nav-text">ZPOPMAX、ZPOPMIN</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZMPOP-%E4%BE%9D%E6%8D%AE%E6%8F%90%E4%BE%9B%E7%9A%84%E6%96%B9%E5%90%91%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E9%9B%86%E5%90%88%E6%8C%87%E5%AE%9A%E6%95%B0%E9%87%8F%E7%9A%84%E5%85%83%E7%B4%A0"><span class="nav-number">2.5.2.6.</span> <span class="nav-text">ZMPOP 依据提供的方向删除指定集合指定数量的元素</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5"><span class="nav-number">2.5.3.</span> <span class="nav-text">查</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ZCARD"><span class="nav-number">2.5.3.1.</span> <span class="nav-text">ZCARD</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZCOUNT%E3%80%81ZLEXCOUNT"><span class="nav-number">2.5.3.2.</span> <span class="nav-text">ZCOUNT、ZLEXCOUNT</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZSCORE"><span class="nav-number">2.5.3.3.</span> <span class="nav-text">ZSCORE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZMSCORE"><span class="nav-number">2.5.3.4.</span> <span class="nav-text">ZMSCORE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZRANDMEMBER"><span class="nav-number">2.5.3.5.</span> <span class="nav-text">ZRANDMEMBER</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZRANGE"><span class="nav-number">2.5.3.6.</span> <span class="nav-text">ZRANGE</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D"><span class="nav-number">2.5.3.6.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%82%E6%95%B0"><span class="nav-number">2.5.3.6.2.</span> <span class="nav-text">参数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-1"><span class="nav-number">2.5.3.6.3.</span> <span class="nav-text">返回值</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="nav-number">2.5.3.6.4.</span> <span class="nav-text">代码示例</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZRANGESTORE"><span class="nav-number">2.5.3.7.</span> <span class="nav-text">ZRANGESTORE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZRANK"><span class="nav-number">2.5.3.8.</span> <span class="nav-text">ZRANK</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZREVRANK"><span class="nav-number">2.5.3.9.</span> <span class="nav-text">ZREVRANK</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZRANGEBYLEX%E3%80%81ZRANGEBYSCORE-%EF%BC%88%E5%BC%83%E7%94%A8%EF%BC%89"><span class="nav-number">2.5.3.10.</span> <span class="nav-text">ZRANGEBYLEX、ZRANGEBYSCORE （弃用）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZREVRANGE%EF%BC%88%E5%BC%83%E7%94%A8%EF%BC%89"><span class="nav-number">2.5.3.11.</span> <span class="nav-text">ZREVRANGE（弃用）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZREVRANGEBYLEX%EF%BC%88%E5%BC%83%E7%94%A8%EF%BC%89"><span class="nav-number">2.5.3.12.</span> <span class="nav-text">ZREVRANGEBYLEX（弃用）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZRANGEBYSCORE%EF%BC%88%E5%BC%83%E7%94%A8%EF%BC%89"><span class="nav-number">2.5.3.13.</span> <span class="nav-text">ZRANGEBYSCORE（弃用）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%B6%E9%9B%86"><span class="nav-number">2.5.4.</span> <span class="nav-text">并集</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ZUNIONSTORE"><span class="nav-number">2.5.4.1.</span> <span class="nav-text">ZUNIONSTORE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZUNION"><span class="nav-number">2.5.4.2.</span> <span class="nav-text">ZUNION</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%A4%E9%9B%86"><span class="nav-number">2.5.5.</span> <span class="nav-text">交集</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ZINTER"><span class="nav-number">2.5.5.1.</span> <span class="nav-text">ZINTER</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZINTERCARD"><span class="nav-number">2.5.5.2.</span> <span class="nav-text">ZINTERCARD</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZINTERSTORE"><span class="nav-number">2.5.5.3.</span> <span class="nav-text">ZINTERSTORE</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%AE%E9%9B%86"><span class="nav-number">2.5.6.</span> <span class="nav-text">差集</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ZDIFFSTORE"><span class="nav-number">2.5.6.1.</span> <span class="nav-text">ZDIFFSTORE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZDIFF"><span class="nav-number">2.5.6.2.</span> <span class="nav-text">ZDIFF</span></a></li></ol></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="border-box website-info-box default">
        
            <div class="copyright-info info-item default">
                ©&nbsp;<span>2020</span>&nbsp;-&nbsp;2023
                
                    &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">uwupu</a>
                
            </div>

            <div class="theme-info info-item default">
                由&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;驱动&nbsp;&amp;&nbsp;主题&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a>
            </div>

            

            
        

        <div class="count-item info-item default">
            
                <span class="count-box border-box word">
                    <span class="item-type border-box">总字数</span>
                    <span class="item-value border-box word">161.4k</span>
                </span>
            

            
                <span class="count-box border-box uv">
                    <span class="item-type border-box">访客数</span>
                    <span class="item-value border-box uv" id="busuanzi_value_site_uv"></span>
                </span>
            

            
                <span class="count-box border-box pv">
                    <span class="item-type border-box">访问量</span>
                    <span class="item-value border-box pv" id="busuanzi_value_site_pv"></span>
                </span>
            
        </div>
    </div>
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="tools-list border-box">
        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input">
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Hash"><span class="nav-number">1.</span> <span class="nav-text">Hash</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-x2F-%E5%9C%BA%E6%99%AF"><span class="nav-number">1.1.</span> <span class="nav-text">使用/场景</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%BA%E6%99%AF"><span class="nav-number">1.1.1.</span> <span class="nav-text">场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90%EF%BC%9A%E5%AD%98%E5%82%A8%E7%94%A8%E6%88%B7%E7%9A%84%E5%B1%9E%E6%80%A7"><span class="nav-number">1.1.2.</span> <span class="nav-text">例子：存储用户的属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90%EF%BC%9A%E5%AD%98%E5%82%A8%E8%AE%BE%E5%A4%87%E7%9A%84%E8%AE%BF%E9%97%AE%E7%8A%B6%E6%80%81"><span class="nav-number">1.1.3.</span> <span class="nav-text">例子：存储设备的访问状态</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.</span> <span class="nav-text">基础命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%91%BD%E4%BB%A4"><span class="nav-number">1.3.</span> <span class="nav-text">其他命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HSET-%E8%AE%BE%E7%BD%AE%E5%80%BC-%E5%8F%AF%E4%BB%A5%E5%A4%9A%E4%B8%AA"><span class="nav-number">1.3.1.</span> <span class="nav-text">HSET 设置值 可以多个</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HSETNX-%E5%BD%93field%E4%B8%8D%E5%AD%98%E5%9C%A8%E5%88%99%E8%AE%BE%E7%BD%AE%E5%80%BC"><span class="nav-number">1.3.2.</span> <span class="nav-text">HSETNX 当field不存在则设置值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HGET-%E8%8E%B7%E5%BE%97field%E7%9A%84value"><span class="nav-number">1.3.3.</span> <span class="nav-text">HGET 获得field的value</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HMGET-%E8%8E%B7%E5%8F%96field%E7%9A%84value-%E5%8F%AF%E4%BB%A5%E5%A4%9A%E4%B8%AA"><span class="nav-number">1.3.4.</span> <span class="nav-text">HMGET 获取field的value 可以多个</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HGETALL-%E8%8E%B7%E5%BE%97%E6%89%80%E6%9C%89field-value"><span class="nav-number">1.3.5.</span> <span class="nav-text">HGETALL 获得所有field-value</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HDEL-%E5%88%A0%E9%99%A4field-%E5%8F%AF%E4%BB%A5%E5%A4%9A%E4%B8%AA"><span class="nav-number">1.3.6.</span> <span class="nav-text">HDEL 删除field 可以多个</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HEXISTS-%E6%9F%A5%E8%AF%A2field%E5%AD%98%E5%9C%A8"><span class="nav-number">1.3.7.</span> <span class="nav-text">HEXISTS 查询field存在</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HLEN-%E8%8E%B7%E5%BE%97field%E6%95%B0%E9%87%8F"><span class="nav-number">1.3.8.</span> <span class="nav-text">HLEN 获得field数量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HSTRLEN-%E8%8E%B7%E5%BE%97value%E7%9A%84%E9%95%BF%E5%BA%A6"><span class="nav-number">1.3.9.</span> <span class="nav-text">HSTRLEN 获得value的长度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HINCRBY-%E5%A2%9E%E5%8A%A0%E6%95%B4%E5%9E%8B%E7%9A%84%E5%80%BC"><span class="nav-number">1.3.10.</span> <span class="nav-text">HINCRBY  增加整型的值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HINCRBYFLOAT-%E5%A2%9E%E5%8A%A0%E6%B5%AE%E7%82%B9%E6%95%B0%E7%9A%84%E5%80%BC"><span class="nav-number">1.3.11.</span> <span class="nav-text">HINCRBYFLOAT  增加浮点数的值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HRANDFIELD-%E9%9A%8F%E6%9C%BA%E8%8E%B7%E5%8F%96field"><span class="nav-number">1.3.12.</span> <span class="nav-text">HRANDFIELD 随机获取field</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HVALS-%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E7%9A%84values"><span class="nav-number">1.3.13.</span> <span class="nav-text">HVALS 获取所有的values</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HMSET%EF%BC%88%E5%BC%83%E7%94%A8%EF%BC%89-%E4%B8%8Ehset%E4%B8%80%E8%87%B4"><span class="nav-number">1.3.14.</span> <span class="nav-text">HMSET（弃用） 与hset一致</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Sorted-Set"><span class="nav-number">2.</span> <span class="nav-text">Sorted Set</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0"><span class="nav-number">2.1.</span> <span class="nav-text">实现</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90%EF%BC%9A%E6%B8%B8%E6%88%8F%E6%8E%92%E5%90%8D%E6%9C%80%E9%AB%98%E5%88%86"><span class="nav-number">2.2.</span> <span class="nav-text">例子：游戏排名最高分</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4-1"><span class="nav-number">2.3.</span> <span class="nav-text">基础命令</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%80%A7%E8%83%BD"><span class="nav-number">2.4.</span> <span class="nav-text">性能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E5%91%BD%E4%BB%A4-1"><span class="nav-number">2.5.</span> <span class="nav-text">其他命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A2%9E"><span class="nav-number">2.5.1.</span> <span class="nav-text">增</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ZADD"><span class="nav-number">2.5.1.1.</span> <span class="nav-text">ZADD</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D-x2F-%E4%BD%BF%E7%94%A8"><span class="nav-number">2.5.1.1.1.</span> <span class="nav-text">介绍/使用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%AF%E4%BB%A5%E7%94%A8%E7%9A%84%E5%8F%82%E6%95%B0"><span class="nav-number">2.5.1.1.2.</span> <span class="nav-text">可以用的参数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0-1"><span class="nav-number">2.5.1.1.3.</span> <span class="nav-text">实现</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="nav-number">2.5.1.1.4.</span> <span class="nav-text">返回值</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81"><span class="nav-number">2.5.1.1.5.</span> <span class="nav-text">代码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0"><span class="nav-number">2.5.2.</span> <span class="nav-text">删</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ZREM"><span class="nav-number">2.5.2.1.</span> <span class="nav-text">ZREM</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZREMRANGEBYLEX"><span class="nav-number">2.5.2.2.</span> <span class="nav-text">ZREMRANGEBYLEX</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZREMRANGEBYSCORE"><span class="nav-number">2.5.2.3.</span> <span class="nav-text">ZREMRANGEBYSCORE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZREMRANGEBYRANK"><span class="nav-number">2.5.2.4.</span> <span class="nav-text">ZREMRANGEBYRANK</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZPOPMAX%E3%80%81ZPOPMIN"><span class="nav-number">2.5.2.5.</span> <span class="nav-text">ZPOPMAX、ZPOPMIN</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZMPOP-%E4%BE%9D%E6%8D%AE%E6%8F%90%E4%BE%9B%E7%9A%84%E6%96%B9%E5%90%91%E5%88%A0%E9%99%A4%E6%8C%87%E5%AE%9A%E9%9B%86%E5%90%88%E6%8C%87%E5%AE%9A%E6%95%B0%E9%87%8F%E7%9A%84%E5%85%83%E7%B4%A0"><span class="nav-number">2.5.2.6.</span> <span class="nav-text">ZMPOP 依据提供的方向删除指定集合指定数量的元素</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5"><span class="nav-number">2.5.3.</span> <span class="nav-text">查</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ZCARD"><span class="nav-number">2.5.3.1.</span> <span class="nav-text">ZCARD</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZCOUNT%E3%80%81ZLEXCOUNT"><span class="nav-number">2.5.3.2.</span> <span class="nav-text">ZCOUNT、ZLEXCOUNT</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZSCORE"><span class="nav-number">2.5.3.3.</span> <span class="nav-text">ZSCORE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZMSCORE"><span class="nav-number">2.5.3.4.</span> <span class="nav-text">ZMSCORE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZRANDMEMBER"><span class="nav-number">2.5.3.5.</span> <span class="nav-text">ZRANDMEMBER</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZRANGE"><span class="nav-number">2.5.3.6.</span> <span class="nav-text">ZRANGE</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%8B%E7%BB%8D"><span class="nav-number">2.5.3.6.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%82%E6%95%B0"><span class="nav-number">2.5.3.6.2.</span> <span class="nav-text">参数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC-1"><span class="nav-number">2.5.3.6.3.</span> <span class="nav-text">返回值</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="nav-number">2.5.3.6.4.</span> <span class="nav-text">代码示例</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZRANGESTORE"><span class="nav-number">2.5.3.7.</span> <span class="nav-text">ZRANGESTORE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZRANK"><span class="nav-number">2.5.3.8.</span> <span class="nav-text">ZRANK</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZREVRANK"><span class="nav-number">2.5.3.9.</span> <span class="nav-text">ZREVRANK</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZRANGEBYLEX%E3%80%81ZRANGEBYSCORE-%EF%BC%88%E5%BC%83%E7%94%A8%EF%BC%89"><span class="nav-number">2.5.3.10.</span> <span class="nav-text">ZRANGEBYLEX、ZRANGEBYSCORE （弃用）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZREVRANGE%EF%BC%88%E5%BC%83%E7%94%A8%EF%BC%89"><span class="nav-number">2.5.3.11.</span> <span class="nav-text">ZREVRANGE（弃用）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZREVRANGEBYLEX%EF%BC%88%E5%BC%83%E7%94%A8%EF%BC%89"><span class="nav-number">2.5.3.12.</span> <span class="nav-text">ZREVRANGEBYLEX（弃用）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZRANGEBYSCORE%EF%BC%88%E5%BC%83%E7%94%A8%EF%BC%89"><span class="nav-number">2.5.3.13.</span> <span class="nav-text">ZRANGEBYSCORE（弃用）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%B6%E9%9B%86"><span class="nav-number">2.5.4.</span> <span class="nav-text">并集</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ZUNIONSTORE"><span class="nav-number">2.5.4.1.</span> <span class="nav-text">ZUNIONSTORE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZUNION"><span class="nav-number">2.5.4.2.</span> <span class="nav-text">ZUNION</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%A4%E9%9B%86"><span class="nav-number">2.5.5.</span> <span class="nav-text">交集</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ZINTER"><span class="nav-number">2.5.5.1.</span> <span class="nav-text">ZINTER</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZINTERCARD"><span class="nav-number">2.5.5.2.</span> <span class="nav-text">ZINTERCARD</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZINTERSTORE"><span class="nav-number">2.5.5.3.</span> <span class="nav-text">ZINTERSTORE</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%AE%E9%9B%86"><span class="nav-number">2.5.6.</span> <span class="nav-text">差集</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ZDIFFSTORE"><span class="nav-number">2.5.6.1.</span> <span class="nav-text">ZDIFFSTORE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ZDIFF"><span class="nav-number">2.5.6.2.</span> <span class="nav-text">ZDIFF</span></a></li></ol></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>



<!-- common -->
<script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/js/dark-light-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/js/libs/anime.min.js"></script>

<!-- local-search -->

    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/js/local-search.js"></script>


<!-- code-block -->

    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/js/code-block.js"></script>


<!-- lazyload -->

    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/js/lazyload.js"></script>


<div class="pjax">
    
        <!-- post-helper -->
        <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/js/post/post-helper.js"></script>

        <!-- toc -->
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/js/post/toc.js"></script>
        

        <!-- copyright-info -->
        
            <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/js/post/copyright-info.js"></script>
        

        <!-- share -->
        
    

    <!-- category-page -->
    

    <!-- links-page -->
    
</div>

<!-- mermaid -->

    
<script src="//cdn.jsdelivr.net/npm/mermaid@10.5.0/dist/mermaid.min.js"></script>

    <script data-pjax="">
      if (window.mermaid) {
        mermaid.init()
      }
    </script>






<!-- pjax -->

    <script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.8.6/source/js/libs/pjax.min.js"></script>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        window.pjax = new Pjax({
            selectors: [
                'head title',
                '.page-container',
                '.pjax'
            ],
            history: true,
            debug: false,
            cacheBust: false,
            timeout: 0,
            analytics: false,
            currentUrlFullReload: false,
            scrollRestoration: false,
        });

        document.addEventListener('pjax:send', () => {
            KEEP.utils.pjaxProgressBarStart()
        });

        document.addEventListener('pjax:complete', () => {
            KEEP.utils.pjaxProgressBarEnd()
            window.pjax.executeScripts(document.querySelectorAll('script[data-pjax], .pjax script'))
            KEEP.initExecute()
        });
    });
</script>






</body></html>